<!DOCTYPE html>
<html xmlns:fb="https://www.facebook.com/2008/fbml">
<html>
<head>
	<title>Like Tracker</title>
</head>
<body>
<script>

	var posts = [];

  	window.fbAsyncInit = function() {

		FB.init({
		  appId      : '1122565244438826',
		  xfbml      : true,
		  version    : 'v2.4'
		});

		FB.login(function(response) {
		  console.log(response);

		  if (response.status=="connected") {
			console.log("You're logged in");

			FB.api('/600250886752341/posts?limit=100', function(response) {
			   console.log(response);
			   postIDs = convertJSONToArray(response);
			   console.log(postIDs);

			   // if posts not null find out who liked each post
			   if (postIDs) {
			   		var postCount = postIDs.length;
			   		console.log(postCount);
			   		for (var i = 0; i < postCount; i++) {
			   			var postID = postIDs[i];
			   			getLikesOfPostWithID(postID);
			   		};
			   }
			}); 

		  } 

		}); 
  	};

	(function(d, s, id){
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.id = id;
		js.src = "//connect.facebook.net/en_US/sdk.js";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk')); 

	function convertJSONToArray(json) {
		var data = json.data;
		var count = data.length;
		var parsedData = [];
		for(var i = 0; i < count; i++) {
		    var post = data[i];
		    parsedData.push(post.id);
		}
		return parsedData;
	}

	function getLikesOfPostWithID(id) {
		

		FB.api(id + '/likes', function(response) {
			var names = []; 
			// store IDs of people who like this post in array
			var peopleWhoLikeThis = response.data;
			//console.log(peopleWhoLikeThis);
			var peopleCount = peopleWhoLikeThis.length;
			for (var i = 0; i < peopleCount; i++) {
				//console.log(peopleWhoLikeThis[i]);
				var userID = String(peopleWhoLikeThis[i].id);
				console.log(userID);
				var name;
				FB.api(userID, {fields: 'name'}, function(response) {
					// console.log(id);
					console.log("IN API CALL:" + response.name);
					name = response.name;
					if (!(name in names)) {
						names.push({
						    key:   name,
						    value: 1
						});
					} else {
						names[name]++;
					}
				});
				//var name = getNameFromUserID(userID);
				
			};
			console.log(names);
		});
		
	}

	// function getNameFromUserID(id) {
	// 	var name = "no name";
	// 	FB.api(id, {fields: 'name'}, function(response) {
	// 		// console.log(id);
	// 		console.log(response.name);
	// 		name = response.name;
	// 	});
	// 	return name;
	// }


</script>

	<div
	  class="fb-like"
	  data-share="true"
	  data-width="450"
	  data-show-faces="true">
	</div>

</body>
</html>